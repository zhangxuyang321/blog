---
layout: pots
title: 数据结构与算法(13)_红黑树
date: 2019-01-07 14:34:14
tags: [算法,笔记]
categories: 算法
---
## 前言
二叉树在频繁的动态更新中,可能会出现树的高度远大于$$log_2n$$的情况,极端情况下,二叉树会退化成链表,各个操作效率下降.我们需要设计一种平衡二叉查找树,来结局这个问题

## 什么是平衡二叉查找树
严格定义是这样的:二叉树中任意一个节点的左右子树高度相差不能大于1.

从这个定义来看,满二叉树和完全二叉树都是平衡二叉树.非完全二叉树也有可能是平衡二叉树.

但是很多平衡二叉查找树其实并没有符合上面的定义,为了实际应用,没必要死抠定义,主要是解决问题.所以,<font color=red>平衡二叉查找树中"平衡"的意思其实就是让整个树左右看起来比较"对称",比较"平衡",不要出现左子树很高,右子树很矮的情况.这就让整个树高度相对低一些,提高操作效率</font>

## 如何定义一个"红黑树"
红黑树的节点,一类被标记为黑色,一类被标记为红色.除此之外还要满足以下几个要求:

* 根节点是黑色的
* 每个叶子节点都是黑色的空节点,也就是说叶子节点不存储数据
* 任何相邻的节点都不能同时为红色,也就是说红色节点是被黑色节点隔开的
* 每个节点,从该节点到达其可达叶子节点的所有路径,都包含相同数目的黑色节点.


上面"叶子节点都是黑色的空节点",主要是为了简化红黑树代码而设置的.

## 为什么说红黑树是"近似平衡"
平衡的意思可以等价为性能不退化."近似平衡"就等价位性能退化不会太严重.

二叉树的很多操作性能都跟树的高度成正比.一棵及其平衡的二叉树的高度大约是$$log_2n$$,所以要证明红黑树是近似平衡的,我们只需要分析红黑树的高度是否比较稳定的趋近$$log_2n$$就好了.

我们来分析一下红黑树的高度.

<font color=red>首先,我们来看,如果将红色节点从红黑树中去掉,那单纯包含黑色节点的红黑树的高度是多少呢?</font>

红色节点删除之后,有些节点就没有负节点了,它们会直接拿这些节点的祖父节点作为父节点,所以之前的二叉树,就变成了四叉树.

//todo 图20

前面红黑树定义中有一条:从任意节点到可达的叶子节点的每个路径包含相同数目的黑色节点.我们从四叉树中取出某些节点放到节点位置,四叉树就变成了完全二叉树.所以仅包含黑色节点的四叉树高度,比包含相同节点数的完全二叉树的高度还要小.

完全二叉树的高度近似$$log_2n$$,这里的四叉黑树的高度低于完全二叉树,所以去掉黑色节点的黑树的高度也不会超过$$log_2n$$.

<font color=red>那现在把红色节点加回去,高度会变成多少呢?</font>

在红黑树中,红色节点不能相邻,也就是说,有一个红色节点就至少要有一个黑色节点,将它跟其他红色节点隔开.红黑树中包含最多黑色节点的路径不会超过$$log_2n$$,所以加入红色节点后不会超过$$2log_2n$$,也就是说红黑树的高度近似$$2log_2n$$.

